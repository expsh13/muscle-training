# 筋トレ記録アプリ 要件定義書（改良版）

## 1. アプリ概要

### 1.1 目的
- 筋トレと体の記録・管理
- ペアプログラミングによる学習を通じた技術スキル向上

### 1.2 対象ユーザー
- 最大2名（完全に独立したGoogleアカウント）
- ペアプロ学習者（開発者）

### 1.3 アクセス環境
- スマホ・PC対応のPWA（オフライン対応なし）
- デプロイ: 無料環境での運用

## 2. 機能要件

### 2.1 認証機能
- Googleアカウント認証
- ユーザー登録・ログイン・ログアウト
- 完全に独立したユーザー管理

### 2.2 体の記録機能
- **記録項目**: 体重、体脂肪
- **操作**: 登録、編集、削除、履歴表示
- **データ同期**: 定期的同期（リアルタイムではない）

### 2.3 筋トレ記録機能

#### 種目管理
- 種目名、重量、メモの記録
- 全てユーザーが作成・管理（初期データなし）

#### 分割グループ管理
- グループ作成（例：プルの日、プッシュの日、脚の日）
- グループ名の編集
- 種目の複数グループ所属可能
- 種目の追加・削除・編集

### 2.4 データ可視化機能

#### 進捗グラフ（折れ線グラフ）
- 体重推移
- 体脂肪推移
- 各筋トレ種目の重量推移

### 2.5 データ管理機能
- データの永続化（クラウド保存）
- マルチデバイス同期（スマホ・PC間）
- 定期的なデータ同期方式

## 3. 非機能要件

### 3.1 技術要件
- **フロントエンド**: Next.js（TypeScript）
- **バックエンド**: Hono（TypeScript）
- **データベース**: Neon（PostgreSQL）
- **ORM**: Drizzle ORM
- **認証**: Auth.js
- **CSS**: Tailwind CSS
- **コード品質**: Biome（リント・フォーマット・a11y統合）
- **グラフ**: Chart.js
- **状態管理**: React標準（useState/useEffect）
- **API設計**: REST API
- **PWA対応**: 基本機能のみ（オフライン対応なし）

### 3.2 アーキテクチャ要件
- **関数型ドメイン駆動設計（DDD）**
  - classを使用しない関数型プログラミングアプローチ
  - 型安全性とimmutabilityを重視
  - 純粋関数による副作用の制御

### 3.3 品質・テスト要件
- **開発手法**: DDD、TDD採用
- **テストフレームワーク**: Vitest
- **UI開発・確認**: Storybook + @storybook/addon-a11y
- **アクセシビリティ**: WCAG AA準拠、Biome a11yルール + @axe-core/react使用
- **コンポーネントテスト**: @testing-library/react

### 3.4 TDD適用戦略

#### 重点TDD適用
- Hono API層（全エンドポイント）
- ビジネスロジック層（データ計算・集計）
- アクセシビリティテスト（全UIコンポーネント）

#### 後からテスト追加
- Next.jsコンポーネント（基本機能のみ）
- データベース統合テスト

#### テスト最小限
- 認証フロー（動作確認程度）
- Chart.js設定（目視確認）
- CSS/スタイリング

### 3.5 開発・運用要件
- **CI/CD**: GitHub Actions使用
- **バージョン管理**: Git（GitHub）
- **デプロイ環境**: 無料プラン利用
- **デプロイ先**:
  - バックエンド: Cloudflare Workers (Hono)
  - フロントエンド: Vercel (Next.js)

### 3.6 アクセシビリティ要件
- **キーボードナビゲーション**: 全機能対応
- **スクリーンリーダー対応**: 適切なセマンティクス・ARIAラベル
- **色のコントラスト**: WCAG AA基準準拠
- **フォーカス管理**: 論理的なtab順序
- **エラーハンドリング**: 適切なaria-invalid、エラーメッセージ

## 4. ペアプログラミング要件

### 4.1 学習目標
- 関数型DDD + TDDの実践的理解
- TypeScript + モダンJavaScriptの習得
- クリーンアーキテクチャの理解
- アクセシビリティへの配慮

### 4.2 ペアプロ方針
- **役割交代**: ドライバー/ナビゲーター定期的交代
- **知識共有**: 実装しながら技術解説
- **コードレビュー**: リアルタイムでの品質確保
- **学習効果**: 理解度確認とフィードバック

### 4.3 開発プロセス
- TDDサイクル（Red-Green-Refactor）の実践
- コミット単位での振り返り
- 技術選択の根拠説明
- 実装パターンの学習

## 5. 除外機能
- ソーシャル機能（共有、友達機能等）
- データエクスポート機能
- プッシュ通知機能
- オフライン対応（PWA基本機能除く）

## 6. 開発スケジュール概要
1. **環境構築** - monorepo setup
2. **認証基盤** - Auth.js + Google OAuth
3. **データベース** - Drizzle + Neon
4. **API開発** - Hono + TDD
5. **UI開発** - Next.js + Storybook
6. **機能実装** - 体重記録 → 筋トレ記録
7. **データ可視化** - Chart.js
8. **PWA対応** - 基本機能
9. **デプロイ** - Vercel + Cloudflare Workers